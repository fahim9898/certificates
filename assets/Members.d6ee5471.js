var U=Object.defineProperty,z=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var P=(l,n,d)=>n in l?U(l,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[n]=d,i=(l,n)=>{for(var d in n||(n={}))K.call(n,d)&&P(l,d,n[d]);if(A)for(var d of A(n))Q.call(n,d)&&P(l,d,n[d]);return l},s=(l,n)=>z(l,J(n));import{j as e,b as t,r as f,F as R}from"./vendor.abe5e19c.js";import{u as w,D as X,M as Y,b as $,T as r,B as Z,g as c,a as j,E as y,F as V}from"./index.945cac23.js";import{C as ee}from"./Card.0a56d7c5.js";import{M as G}from"./Modal.395016a9.js";import{I as L}from"./InputLable.a582803e.js";const ae=({modalObj:l,editValue:n,setEditValue:d})=>{const{data:p,setData:b,loadingDone:_}=w({method:"get",url:X},"groups");return e(G,s(i({},l),{modalWidth:"700px",children:t("div",{className:"modal-body two-col-grid",children:[t("fieldset",{className:"form-group",children:[e("label",{children:"Name"}),e("input",{type:"text",value:n.member_name,onChange:o=>d(s(i({},n),{member_name:o.target.value})),className:"form-control",placeholder:"Name",required:!0})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Profession"}),e("input",{type:"text",value:n.member_profession,onChange:o=>d(s(i({},n),{member_profession:o.target.value})),className:"form-control",placeholder:"Profession"})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Gender"}),t("select",{className:"form-control drop-icon",value:n.gender,onChange:o=>d(s(i({},n),{gender:o.target.value})),children:[e("option",{value:"0",children:"Male"}),e("option",{value:"1",children:"Female"})]})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Dob"}),e("input",{type:"date",value:n.dob,onChange:o=>d(s(i({},n),{dob:o.target.value})),className:"form-control",placeholder:"dob",required:!0})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Aniversary"}),e("input",{type:"date",value:n.aniversary,onChange:o=>d(s(i({},n),{aniversary:o.target.value})),className:"form-control",placeholder:"Aniversary"})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Contact No"}),e("input",{type:"text",value:n.contact_no,onChange:o=>d(s(i({},n),{contact_no:o.target.value})),className:"form-control",placeholder:"Contact No",required:!0})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Address"}),e("input",{type:"text",value:n.address,onChange:o=>d(s(i({},n),{address:o.target.value})),className:"form-control",placeholder:"Address",required:!0})]}),t("fieldset",{className:"form-group",children:[e("label",{children:" Profile Picture"}),e("input",{type:"file",id:"member-profile-file-update-1",accept:"image/*",className:"form-control"})]}),t("fieldset",{className:"form-group",children:[e("label",{children:" Group Information"}),t(L.LabelSelect,{value:n.branch_group_id,required:!0,label:"Group",onChange:o=>d(s(i({},n),{branch_group_id:o.target.value})),invalidText:"Need to select Group",children:[e("option",{value:"",children:"Select Group"}),p&&p.map(o=>t("option",{value:o.id,children:["Group: ",o.name," | Time: ",o.start_time," - ",o.end_time]},o.id))]})]})]})}))},re=({modalObj:l,editValue:n,setEditValue:d})=>{const{data:p,setData:b,loadingDone:_}=w({method:"get",url:Y},"packages");return e(G,s(i({},l),{modalWidth:"500px",children:t("div",{className:"modal-body one-col-grid",children:[t("fieldset",{className:"form-group",children:[e("label",{children:" Package Information"}),t(L.LabelSelect,{value:n.branch_package_id,required:!0,label:"Packages",onChange:o=>d(s(i({},n),{branch_package_id:o.target.value})),invalidText:"Need to select Group",children:[e("option",{value:"",children:"Select Package"}),p&&p.map(o=>e("option",{value:o.id,children:o.package_name},o.id))]})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Note"}),e("input",{type:"text",value:n.note,onChange:o=>d(s(i({},n),{note:o.target.value})),className:"form-control",placeholder:"Name",required:!0})]}),t("fieldset",{className:"form-group",children:[e("label",{children:"Due Days"}),e("input",{type:"text",value:n.due_days,onChange:o=>{const N=o.target.value.replace(/\D/g,"");d(s(i({},n),{due_days:N}))},className:"form-control",placeholder:"Due Days",required:!0})]})]})}))},me=()=>{const[l,n]=f.exports.useState({formId:"staff-member-form-edit",modalId:"staff-member-modal-edit",title:"Edit Member"}),[d,p]=f.exports.useState({formId:"staff-member-form-renew",modalId:"staff-member-modal-renew",title:"Renew Membership"}),{isLoading:b,callback:_}=$(),{isLoading:o,callback:N}=$(),{data:g,setData:T,loadingDone:B}=w({method:"get",url:y},"members"),[m,H]=f.exports.useState({branch_group_id:"",member_name:"",member_profession:"",profile_pic:"",gender:"",dob:"",aniversary:"",contact_no:"",address:"",working_hours:"",salary_amount:""}),[k,x]=f.exports.useState({note:"",branch_member_id:"",branch_package_id:"",due_days:0});function I(a,h){N({method:"get",url:y+"/"+a.id+"/edit",success:u=>{window.Notify({status:"success",message:u.data.message}),r.fn.updateTableWithId(g,s(i({},a),{is_active:h}),T,"id")}})}function q(){let a=new FormData;for(var h in m)a.append(h,m[h]);a.delete("profile_pic"),(!m.aniversary||m.aniversary=="")&&a.delete("aniversary");let u=document.getElementById("member-profile-file-update-1");u.files.length&&(console.log("Files Uplod"),a.append("profile_pic",u.files[0])),a.append("_method","patch"),_({method:"post",url:y+"/"+m.id,data:a,headers:{"Content-Type":"multipart/form-data"},success:v=>{var C,D,M,S;window.Notify({status:"success",message:v.data.message}),window.$(`#${l.modalId}`).modal("hide");let W=s(i({},m),{profile_pic:(D=(C=v.data)==null?void 0:C.member)==null?void 0:D.profile_pic,member_group:((S=(M=v.data)==null?void 0:M.member)==null?void 0:S.member_group)||m.member_group});r.fn.updateTableWithId(g,W,T,"id")},error:v=>{window.$(`#${l.modalId}`).modal("hide")}})}function E(a){H(a),window.$(`#${l.modalId}`).modal("show"),window.$(`#${l.formId}`).off("submit")}function O(){console.log("Renew Submit"),_({method:"post",url:V,data:k,success:a=>{window.Notify({status:"success",message:a.data.message}),window.$(`#${d.modalId}`).modal("hide");let h=a.data.member,u=s(i({},h),{branch_package:a.data.package,member_transaction:a.data.member_transaction});r.fn.updateTableWithId(g,u,T,"id")},error:a=>{window.$(`#${d.modalId}`).modal("hide")}})}function F(a){x({branch_member_id:a.id,note:"",branch_package_id:a.branch_package.id,due_days:0}),window.$(`#${d.modalId}`).modal("show"),window.$(`#${d.formId}`).off("submit")}return f.exports.useEffect(()=>(r.search.clear(),r.search.push([{id:"#date-min",type:"date",placeholder:"Start Date"},{id:"#date-max",type:"date",placeholder:"End Date"}],"input-date","date-minmax",15),()=>{r.search.clear()}),[]),t(R,{children:[e(Z,{title:"Members",links:[{name:"Home",link:"/branch-admin"},{name:"Members",link:"/branch-admin/members"}]}),e(ee,{title:"Members",button:{name:"Add",link:"member-add"},children:t(r,{tableId:".table-brand-staff",loadingDone:B,footerSelect:!0,filter:!0,children:[e(r.Header,{children:t(r.Row,{children:[e(r.TH,{children:"Id"}),e(r.TH,{children:"Name"}),e(r.TH,{children:"Package"}),e(r.TH,{children:"Profession"}),e(r.TH,{children:"Profile Pic"}),e(r.TH,{children:"Gender"}),e(r.TH,{children:"Dob"}),e(r.TH,{children:"Aniversary"}),e(r.TH,{children:"Contact No"}),e(r.TH,{children:"Address"}),e(r.TH,{children:"Group"}),e(r.TH,{children:"Start Date"}),e(r.TH,{children:"End Date"}),e(r.TH,{children:"Remaining Days"}),e(r.TH,{children:"Status"}),e(r.TH,{children:"Date"}),e(r.TH,{children:"Actions"})]})}),e(r.Body,{children:g&&g.map((a,h)=>t(r.Row,{children:[e(r.TH,{children:c(()=>a.id)}),e(r.TH,{children:c(()=>a.member_name)}),e(r.TH,{children:c(()=>a.branch_package.package_name)}),e(r.TH,{children:c(()=>a.member_profession)}),e(r.TH,{children:e("a",{href:j(a.profile_pic),"data-fancybox":"images",children:e("img",{className:"table-img",src:j(a.profile_pic),alt:""})})}),e(r.TH,{children:c(()=>a.gender?"Female":"Male")}),e(r.TH,{children:c(()=>a.dob)}),e(r.TH,{children:c(()=>a.aniversary)}),e(r.TH,{children:c(()=>a.contact_no)}),e(r.TH,{children:c(()=>a.address)}),t(r.TH,{children:[c(()=>a.member_group.name)," ",e("br",{}),c(()=>a.member_group.start_time)," -"," ",c(()=>a.member_group.end_time)]}),e(r.TH,{children:c(()=>a.start_date)}),e(r.TH,{children:c(()=>a.end_date)}),e(r.TH,{children:c(()=>a.remaining_days)<10?t(R,{children:[c(()=>a.remaining_days),e("span",{className:"cursor-pointer ml-1 badge badge-danger",onClick:()=>F(a),children:"Upgrade"})]}):c(()=>a.remaining_days)}),e(r.TH,{children:a.is_active?e("span",{className:"cursor-pointer badge badge-success",onClick:()=>I(a,!1),children:"Active"}):e("span",{className:"cursor-pointer badge badge-danger",onClick:()=>I(a,!0),children:"In Active"})}),e(r.TH,{children:c(()=>new Date(a.created_at).toLocaleDateString())}),e(r.TH,{children:e("i",{className:"feather icon-edit cursor-pointer",onClick:()=>E(a)})})]},a.id))})]})}),e(ae,{editValue:m,setEditValue:H,modalObj:s(i({},l),{onSubmit:q,isLoading:b})}),e(re,{editValue:k,setEditValue:x,modalObj:s(i({},d),{onSubmit:O,isLoading:b})})]})};export{me as default};
