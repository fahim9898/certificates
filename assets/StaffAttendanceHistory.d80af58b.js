import{r as l,i as d,b as i,F as p,j as e}from"./vendor.61ffbfff.js";import{u as b,b as B,B as F,g as r,q as g}from"./index.85da2068.js";import{C as I}from"./Card.a57d113a.js";import{I as O}from"./InputLable.103d759b.js";import{S as x,a as T,P as X,F as E,C as R,D as Y,B as M}from"./PrinterOutlined.265a7a5f.js";import{B as y}from"./styleChecker.02bbd6d7.js";const{RangePicker:q}=Y,{Option:z}=x,$=()=>{l.exports.useState(new Date().getMonth()),l.exports.useState(new Date().getFullYear());const[k,H]=l.exports.useState(Array.from(Array(d(new Date).daysInMonth()).keys())),S="Staff Register",C=[{name:"Home",link:"/branch-admin"},{name:"Staff Register",link:"/branch-admin/staff-attendance"}];b({method:"get",url:"/api/branch_staff_attendance"},"branch");const{data:h,setData:V,loadingDone:_,callback:D}=B(),{data:m,setData:G,isLoading:v}=b({method:"get",url:"/api/my_branch_staff"},"staff");let[c,u]=l.exports.useState(""),[o,w]=l.exports.useState("");l.exports.useEffect(()=>{o&&D({method:"get",url:"/api/branch_staff_attendance/"+o+"/edit"},"attendances")},[o]);function A(t){let a=h.filter(f=>d(f.created_at).isSame(t,"day"));if(!a.length)return[];let s=0;a[0].checkin_time&&a[0].checkout_time?s=2:a[0].checkin_time&&!a[0].checkout_time?s=1:a[0].checkin_time||(s=0);let n;switch(s){case 0:n=[{type:"error",content:"Absent"}];break;case 1:n=[{type:"success",content:"Present"},{type:"warning",content:"Not Checkout"}];break;case 2:n=[{type:"success",content:"Present"}];break}return n||[]}function L(t,a){const s=A(t);return e("ul",{className:"events",children:s.map(n=>e("li",{children:e(M,{status:n.type,text:n.content})},n.content))})}function N(t,a,s){var n=document.getElementById("table-attendance"),f=XLSX.utils.table_to_book(n,{sheet:"sheet1"});let P=m.filter(j=>j.id==o)[0];return s?XLSX.write(f,{bookType:t,bookSST:!0,type:"base64"}):XLSX.writeFile(f,a||"Attendance-"+r(()=>P.staff_name)+"."+(t||"xlsx"))}return i(p,{children:[e(F,{title:S,links:C}),i("div",{className:"filter-options mb-2",style:{paddingTop:"10px",marginBottom:"0px"},children:[e(x,{showSearch:!0,defaultValue:"Select Staff",onChange:t=>w(t),style:{width:250},loading:v,optionFilterProp:"children",filterOption:(t,a)=>a.children.toLowerCase().indexOf(t.toLowerCase())>=0,filterSort:(t,a)=>t.children.toLowerCase().localeCompare(a.children.toLowerCase()),children:m&&m.map(t=>e(z,{value:r(()=>t.id),children:r(()=>t.staff_name)},r(()=>t.id)))}),e(T,{direction:"vertical",size:12,style:{position:"absolute",right:"35px"},children:e(q,{onChange:(t,a)=>{console.log(t,a),u(t)}})}),i("div",{className:"row w-100 d-none",children:[e(O.LabelInput,{style:{width:"min(500px, 85vw)"},className:"form-control h-100",type:"text",required:!0,name:"daterange",value:c,onChange:t=>u(t.target.value),label:"Date",invalidText:"Date is required"}),k&&e("div",{className:"input-grp mt-0 ml-2 float-right",children:e("div",{className:"btn btn-info",onClick:()=>{g("member-attendance-table")},children:"Print"})})]})]}),i("div",{id:"staff-attendance-table",className:"d-none",children:[e("div",{className:"row",children:e("div",{className:"col-12 mb-2",children:e("h3",{children:"Attendance"})})}),i("table",{id:"table-attendance",className:"table",children:[e("thead",{children:i("tr",{children:[e("th",{children:"Date"}),e("th",{children:"Check In"}),e("th",{children:"Check Out"}),e("th",{children:"Status"})]})}),e("tbody",{children:h&&h.filter(t=>!c||c&&d(t.created_at).isSameOrAfter(c[0],"day")&&d(t.created_at).isSameOrBefore(c[1],"day")).map((t,a)=>i("tr",{children:[e("th",{children:r(()=>d(t.created_at).format("DD-MM-YYYY"))}),e("th",{children:r(()=>t.checkin_time)}),e("th",{children:r(()=>t.checkout_time)}),e("th",{children:r(()=>t.checkin_time?"Present":"Absent")})]},t.id))})]})]}),o&&e(I,{loadingDone:_,children:h&&i(p,{children:[e(y,{onClick:()=>g("staff-attendance-table"),style:{position:"absolute",top:"15px"},type:"secondory",shape:"circle",icon:e(X,{}),size:"medium"}),e(y,{onClick:()=>N("xlsx"),style:{position:"absolute",top:"15px",left:"60px"},type:"secondory",shape:"circle",icon:e(E,{}),size:"medium"}),e("span",{children:e(R,{validRange:c,dateCellRender:L,mode:"month"})})]})})]})};export{$ as default};
