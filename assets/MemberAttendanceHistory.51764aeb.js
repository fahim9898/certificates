import{r as l,i as d,b as i,F as f,j as e}from"./vendor.abe5e19c.js";import{b as j,u as B,B as F,g as s,q as b}from"./index.945cac23.js";import{C as I}from"./Card.0a56d7c5.js";import{I as O}from"./InputLable.a582803e.js";import{S as g,a as M,P as T,F as X,C as E,D as R,B as Y}from"./PrinterOutlined.e9a3759a.js";import{B as x}from"./styleChecker.453c9714.js";const{RangePicker:q}=R,{Option:z}=g,$=()=>{l.exports.useState(new Date().getMonth()),l.exports.useState(new Date().getFullYear());const[k,H]=l.exports.useState(Array.from(Array(d(new Date).daysInMonth()).keys())),y="Member Register",S=[{name:"Home",link:"/branch-admin"},{name:"Member Register",link:"/branch-admin/member-attendance"}],{data:m,setData:V,loadingDone:C,callback:D}=j(),{data:u,setData:G,isLoading:v}=B({method:"get",url:"/api/branch_member"},"members");let[c,p]=l.exports.useState(""),[o,w]=l.exports.useState("");l.exports.useEffect(()=>{o&&D({method:"get",url:"/api/branch_member_attendance/"+o+"/edit"},"attendances")},[o]);function _(t){let a=m.filter(h=>d(h.created_at).isSame(t,"day"));if(!a.length)return[];let r=0;a[0].checkin_time&&a[0].checkout_time?r=2:a[0].checkin_time&&!a[0].checkout_time?r=1:a[0].checkin_time||(r=0);let n;switch(r){case 0:n=[{type:"error",content:"Absent"}];break;case 1:n=[{type:"success",content:"Present"},{type:"warning",content:"Not Checkout"}];break;case 2:n=[{type:"success",content:"Present"}];break}return n||[]}function A(t,a){const r=_(t);return e("ul",{className:"events",children:r.map(n=>e("li",{children:e(Y,{status:n.type,text:n.content})},n.content))})}function L(t,a,r){var n=document.getElementById("table-attendance"),h=XLSX.utils.table_to_book(n,{sheet:"sheet1"});let N=u.filter(P=>P.id==o)[0];return r?XLSX.write(h,{bookType:t,bookSST:!0,type:"base64"}):XLSX.writeFile(h,a||"Attendance-"+s(()=>N.staff_name)+"."+(t||"xlsx"))}return i(f,{children:[e(F,{title:y,links:S}),i("div",{className:"filter-options mb-2",style:{paddingTop:"10px",marginBottom:"0px"},children:[e(g,{showSearch:!0,defaultValue:"Select Member",onChange:t=>w(t),style:{width:250},loading:v,optionFilterProp:"children",filterOption:(t,a)=>a.children.toLowerCase().indexOf(t.toLowerCase())>=0,filterSort:(t,a)=>t.children.toLowerCase().localeCompare(a.children.toLowerCase()),children:u&&u.map(t=>e(z,{value:s(()=>t.id),children:s(()=>t.member_name)},s(()=>t.id)))}),e(M,{direction:"vertical",size:12,style:{position:"absolute",right:"35px"},children:e(q,{onChange:(t,a)=>{console.log(t,a),p(t)}})}),i("div",{className:"row w-100 d-none",children:[e(O.LabelInput,{style:{width:"min(500px, 85vw)"},className:"form-control h-100",type:"text",required:!0,name:"daterange",value:c,onChange:t=>p(t.target.value),label:"Date",invalidText:"Date is required"}),k&&e("div",{className:"input-grp mt-0 ml-2 float-right",children:e("div",{className:"btn btn-info",onClick:()=>{b("member-attendance-table")},children:"Print"})})]})]}),i("div",{id:"staff-attendance-table",className:"d-none",children:[e("div",{className:"row",children:e("div",{className:"col-12 mb-2",children:e("h3",{children:"Attendance"})})}),i("table",{id:"table-attendance",className:"table",children:[e("thead",{children:i("tr",{children:[e("th",{children:"Date"}),e("th",{children:"Check In"}),e("th",{children:"Check Out"}),e("th",{children:"Status"})]})}),e("tbody",{children:m&&m.filter(t=>!c||c&&d(t.created_at).isSameOrAfter(c[0],"day")&&d(t.created_at).isSameOrBefore(c[1],"day")).map((t,a)=>i("tr",{children:[e("th",{children:s(()=>d(t.created_at).format("DD-MM-YYYY"))}),e("th",{children:s(()=>t.checkin_time)}),e("th",{children:s(()=>t.checkout_time)}),e("th",{children:s(()=>t.checkin_time?"Present":"Absent")})]},t.id))})]})]}),o&&e(I,{loadingDone:C,children:m&&i(f,{children:[e(x,{onClick:()=>b("staff-attendance-table"),style:{position:"absolute",top:"15px"},type:"secondory",shape:"circle",icon:e(T,{}),size:"medium"}),e(x,{onClick:()=>L("xlsx"),style:{position:"absolute",top:"15px",left:"60px"},type:"secondory",shape:"circle",icon:e(X,{}),size:"medium"}),e("span",{children:e(E,{validRange:c,dateCellRender:A,mode:"month"})})]})})]})};export{$ as default};
