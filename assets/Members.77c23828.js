import{j as e,c as d,r as u,F as I}from"./vendor.436bddb5.js";import{u as T,D as G,M as L,b as M,T as r,B,g as l,a as x,E as N,F as O}from"./index.039e5ba8.js";import{C as q}from"./Card.50e90fed.js";import{M as C}from"./Modal.e818ba0e.js";import{I as D}from"./InputLable.84bb3852.js";const E=({modalObj:i,editValue:o,setEditValue:t})=>{const{data:c,setData:g,loadingDone:f}=T({method:"get",url:G},"groups");return e(C,{...i,modalWidth:"700px",children:d("div",{className:"modal-body two-col-grid",children:[d("fieldset",{className:"form-group",children:[e("label",{children:"Name"}),e("input",{type:"text",value:o.member_name,onChange:n=>t({...o,member_name:n.target.value}),className:"form-control",placeholder:"Name",required:!0})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Profession"}),e("input",{type:"text",value:o.member_profession,onChange:n=>t({...o,member_profession:n.target.value}),className:"form-control",placeholder:"Profession"})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Gender"}),d("select",{className:"form-control drop-icon",value:o.gender,onChange:n=>t({...o,gender:n.target.value}),children:[e("option",{value:"0",children:"Male"}),e("option",{value:"1",children:"Female"})]})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Dob"}),e("input",{type:"date",value:o.dob,onChange:n=>t({...o,dob:n.target.value}),className:"form-control",placeholder:"dob",required:!0})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Aniversary"}),e("input",{type:"date",value:o.aniversary,onChange:n=>t({...o,aniversary:n.target.value}),className:"form-control",placeholder:"Aniversary"})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Contact No"}),e("input",{type:"text",value:o.contact_no,onChange:n=>t({...o,contact_no:n.target.value}),className:"form-control",placeholder:"Contact No",required:!0})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Address"}),e("input",{type:"text",value:o.address,onChange:n=>t({...o,address:n.target.value}),className:"form-control",placeholder:"Address",required:!0})]}),d("fieldset",{className:"form-group",children:[e("label",{children:" Profile Picture"}),e("input",{type:"file",id:"member-profile-file-update-1",accept:"image/*",className:"form-control"})]}),d("fieldset",{className:"form-group",children:[e("label",{children:" Group Information"}),d(D.LabelSelect,{value:o.branch_group_id,required:!0,label:"Group",onChange:n=>t({...o,branch_group_id:n.target.value}),invalidText:"Need to select Group",children:[e("option",{value:"",children:"Select Group"}),c&&c.map(n=>d("option",{value:n.id,children:["Group: ",n.name," | Time: ",n.start_time," - ",n.end_time]},n.id))]})]})]})})},F=({modalObj:i,editValue:o,setEditValue:t})=>{const{data:c,setData:g,loadingDone:f}=T({method:"get",url:L},"packages");return e(C,{...i,modalWidth:"500px",children:d("div",{className:"modal-body one-col-grid",children:[d("fieldset",{className:"form-group",children:[e("label",{children:" Package Information"}),d(D.LabelSelect,{value:o.branch_package_id,required:!0,label:"Packages",onChange:n=>t({...o,branch_package_id:n.target.value}),invalidText:"Need to select Group",children:[e("option",{value:"",children:"Select Package"}),c&&c.map(n=>e("option",{value:n.id,children:n.package_name},n.id))]})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Payment Mode"}),e("input",{type:"text",value:o.note,onChange:n=>t({...o,note:n.target.value}),className:"form-control",placeholder:"Payment Mode",required:!0})]}),d("fieldset",{className:"form-group",children:[e("label",{children:"Due Days"}),e("input",{type:"text",value:o.due_days,onChange:n=>{const _=n.target.value.replace(/\D/g,"");t({...o,due_days:_})},className:"form-control",placeholder:"Due Days",required:!0})]})]})})},Y=()=>{const[i,o]=u.exports.useState({formId:"staff-member-form-edit",modalId:"staff-member-modal-edit",title:"Edit Member"}),[t,c]=u.exports.useState({formId:"staff-member-form-renew",modalId:"staff-member-modal-renew",title:"Renew Membership"}),{isLoading:g,callback:f}=M(),{isLoading:n,callback:_}=M(),{data:p,setData:v,loadingDone:S}=T({method:"get",url:N},"members"),[s,y]=u.exports.useState({branch_group_id:"",member_name:"",member_profession:"",profile_pic:"",gender:"",dob:"",aniversary:"",contact_no:"",address:"",working_hours:"",salary_amount:""}),[w,H]=u.exports.useState({note:"",branch_member_id:"",branch_package_id:"",due_days:0});function k(a,m){_({method:"get",url:N+"/"+a.id+"/edit",success:h=>{window.Notify({status:"success",message:h.data.message}),r.fn.updateTableWithId(p,{...a,is_active:m},v,"id")}})}function P(){let a=new FormData;for(var m in s)a.append(m,s[m]);a.delete("profile_pic"),(!s.aniversary||s.aniversary=="")&&a.delete("aniversary");let h=document.getElementById("member-profile-file-update-1");h.files.length&&(console.log("Files Uplod"),a.append("profile_pic",h.files[0])),a.append("_method","patch"),f({method:"post",url:N+"/"+s.id,data:a,headers:{"Content-Type":"multipart/form-data"},success:b=>{window.Notify({status:"success",message:b.data.message}),window.$(`#${i.modalId}`).modal("hide");let j={...s,profile_pic:b.data?.member?.profile_pic,member_group:b.data?.member?.member_group||s.member_group};r.fn.updateTableWithId(p,j,v,"id")},error:b=>{window.$(`#${i.modalId}`).modal("hide")}})}function A(a){y(a),window.$(`#${i.modalId}`).modal("show"),window.$(`#${i.formId}`).off("submit")}function R(){console.log("Renew Submit"),f({method:"post",url:O,data:w,success:a=>{window.Notify({status:"success",message:a.data.message}),window.$(`#${t.modalId}`).modal("hide");let h={...a.data.member,branch_package:a.data.package,member_transaction:a.data.member_transaction};r.fn.updateTableWithId(p,h,v,"id")},error:a=>{window.$(`#${t.modalId}`).modal("hide")}})}function $(a){H({branch_member_id:a.id,note:"",branch_package_id:a.branch_package.id,due_days:0}),window.$(`#${t.modalId}`).modal("show"),window.$(`#${t.formId}`).off("submit")}return u.exports.useEffect(()=>(r.search.clear(),r.search.push([{id:"#date-min",type:"date",placeholder:"Start Date"},{id:"#date-max",type:"date",placeholder:"End Date"}],"input-date","date-minmax",15),()=>{r.search.clear()}),[]),d(I,{children:[e(B,{title:"Members",links:[{name:"Home",link:"/branch-admin"},{name:"Members",link:"/branch-admin/members"}]}),e(q,{title:"Members",button:{name:"Add",link:"member-add"},children:d(r,{tableId:".table-brand-staff",loadingDone:S,footerSelect:!0,filter:!0,children:[e(r.Header,{children:d(r.Row,{children:[e(r.TH,{children:"Id"}),e(r.TH,{children:"Name"}),e(r.TH,{children:"Package"}),e(r.TH,{children:"Profession"}),e(r.TH,{children:"Profile Pic"}),e(r.TH,{children:"Gender"}),e(r.TH,{children:"Dob"}),e(r.TH,{children:"Aniversary"}),e(r.TH,{children:"Contact No"}),e(r.TH,{children:"Address"}),e(r.TH,{children:"Group"}),e(r.TH,{children:"Start Date"}),e(r.TH,{children:"End Date"}),e(r.TH,{children:"Remaining Days"}),e(r.TH,{children:"Status"}),e(r.TH,{children:"Date"}),e(r.TH,{children:"Actions"})]})}),e(r.Body,{children:p&&p.map((a,m)=>d(r.Row,{children:[e(r.TH,{children:l(()=>a.id)}),e(r.TH,{children:l(()=>a.member_name)}),e(r.TH,{children:l(()=>a.branch_package.package_name)}),e(r.TH,{children:l(()=>a.member_profession)}),e(r.TH,{children:e("a",{href:x(a.profile_pic),"data-fancybox":"images",children:e("img",{className:"table-img",src:x(a.profile_pic),alt:""})})}),e(r.TH,{children:l(()=>a.gender?"Female":"Male")}),e(r.TH,{children:l(()=>a.dob)}),e(r.TH,{children:l(()=>a.aniversary)}),e(r.TH,{children:l(()=>a.contact_no)}),e(r.TH,{children:l(()=>a.address)}),d(r.TH,{children:[l(()=>a.member_group.name)," ",e("br",{}),l(()=>a.member_group.start_time)," -"," ",l(()=>a.member_group.end_time)]}),e(r.TH,{children:l(()=>a.start_date)}),e(r.TH,{children:l(()=>a.end_date)}),e(r.TH,{children:l(()=>a.remaining_days)<10?d(I,{children:[l(()=>a.remaining_days),e("span",{className:"cursor-pointer ml-1 badge badge-danger",onClick:()=>$(a),children:"Upgrade"})]}):l(()=>a.remaining_days)}),e(r.TH,{children:a.is_active?e("span",{className:"cursor-pointer badge badge-success",onClick:()=>k(a,!1),children:"Active"}):e("span",{className:"cursor-pointer badge badge-danger",onClick:()=>k(a,!0),children:"In Active"})}),e(r.TH,{children:l(()=>new Date(a.created_at).toIndiaDate())}),e(r.TH,{children:e("i",{className:"feather icon-edit cursor-pointer",onClick:()=>A(a)})})]},a.id))})]})}),e(E,{editValue:s,setEditValue:y,modalObj:{...i,onSubmit:P,isLoading:g}}),e(F,{editValue:w,setEditValue:H,modalObj:{...t,onSubmit:R,isLoading:g}})]})};export{Y as default};
