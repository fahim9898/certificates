import{j as e,b as l,r as f,q as M,F as E}from"./vendor.61ffbfff.js";import{u as k,b as N,T as a,B as j,g as h,a as H,r as b,t as L}from"./index.85da2068.js";import{C as P}from"./Card.a57d113a.js";import{M as B}from"./Modal.d8f45e11.js";import"./InputLable.103d759b.js";const q=({modalObj:o,editValue:p,setEditValue:s})=>{function c(d){const{name:u,value:m}=d.target;s({...p,[u]:m})}return e(B,{...o,modalWidth:"700px",children:l("div",{className:"modal-body two-col-grid",children:[l("fieldset",{className:"form-group",children:[e("label",{children:"Name"}),e("input",{type:"text",name:"name",value:p.name,onChange:d=>c(d),className:"form-control",placeholder:"Name",required:!0})]}),l("fieldset",{className:"form-group",children:[e("label",{children:"Email"}),e("input",{type:"email",name:"email",value:p.email,onChange:d=>c(d),className:"form-control",placeholder:"Email",required:!0})]}),l("fieldset",{className:"form-group",children:[e("label",{children:"Phone"}),e("input",{type:"text",name:"phone",value:p.phone,onChange:d=>c(d),className:"form-control",placeholder:"Phone",required:!0})]}),l("fieldset",{className:"form-group",children:[e("label",{children:"Profile Picture"}),e("input",{type:"file",accept:"image/*",name:"profile_pic",id:"admin-profile-pic",className:"form-control"})]})]})})},U=()=>{const[o,p]=f.exports.useState({formId:"admin-form-edit",modalId:"admin-modal-edit",title:"Edit Admin"}),[s,c]=f.exports.useState({name:"",email:"",phone:""});let d=M(),u=L;const{data:m,setData:g,loadingDone:x}=k({method:"get",url:u},i=>d.id?i.data.branches.reduce((r,t)=>(t.id==d.id&&r.push(...t.branch_admin.map(n=>({...n,branch:t}))),r),[]):i.data.branches.reduce((r,t)=>(r.push(...t.branch_admin.map(n=>({...n,branch:t}))),r),[])),{isLoading:F,callback:w}=N(),{isLoading:A,callback:I}=N();function T(i,r){let t={};r?t={method:"get",url:b+"/"+i.id}:t={method:"delete",url:b+"/"+i.id},w({...t,success:n=>{window.Notify({status:"success",message:n.data.message}),a.fn.updateTableWithId(m,{...i,is_active:r},g,"id")}})}f.exports.useEffect(()=>(a.search.clear(),a.search.push([{id:"#date-min",type:"date",placeholder:"Start Date"},{id:"#date-max",type:"date",placeholder:"End Date"}],"input-date","date-minmax",7),()=>{a.search.clear()}),[]);const _="Admins",y=[{name:"Home",link:"/gym-admin"},{name:"Admins",link:"/gym-admin/admins"}];let C=0;function S(i){c(i),window.$(`#${o.modalId}`).modal("show"),window.$(`#${o.formId}`).off("submit")}function v(){let i=new FormData;for(var r in s)i.append(r,s[r]);let t=$('#admin-form-edit input[type="file"]')[0]?.files[0];i.delete("profile_pic"),t&&i.append("profile_pic",t),i.append("_method","patch"),I({method:"post",url:b+"/"+s.id,data:i,headers:{"Content-Type":"multipart/form-data"},success:n=>{window.Notify({status:"success",message:n.data.message}),window.$(`#${o.modalId}`).modal("hide");let D={...s,profile_pic:n.data?.branch_admin?.profile_pic};a.fn.updateTableWithId(m,D,g,"id")},error:n=>{window.$(`#${o.modalId}`).modal("hide")}})}return l(E,{children:[e(j,{title:_,links:y}),e(P,{title:"Admins",button:{name:"Add",link:"admin-add"},children:l(a,{tableId:".table-brand-staff",loadingDone:x,footerSelect:!0,filter:!0,children:[e(a.Header,{children:l(a.Row,{children:[e(a.TH,{children:"Id"}),e(a.TH,{children:"Branch"}),e(a.TH,{children:"Name"}),e(a.TH,{children:"Email"}),e(a.TH,{children:"Profile"}),e(a.TH,{children:"Phone"}),e(a.TH,{children:"Status"}),e(a.TH,{children:"Date"}),e(a.TH,{children:"Actions"})]})}),e(a.Body,{children:m&&m.map((i,r)=>l(a.Row,{children:[e(a.TH,{children:h(()=>++C)}),e(a.TH,{children:h(()=>i.branch.branch_name)}),e(a.TH,{children:h(()=>i.name)}),e(a.TH,{children:h(()=>i.email)}),e(a.TH,{children:e("a",{href:H(i.profile_pic),"data-fancybox":"images",children:e("img",{className:"table-img",src:H(i.profile_pic),alt:""})})}),e(a.TH,{children:h(()=>i.phone)}),e(a.TH,{children:i.is_active?e("span",{className:"cursor-pointer badge badge-success",onClick:()=>T(i,!1),children:"Active"}):e("span",{className:"cursor-pointer badge badge-danger",onClick:()=>T(i,!0),children:"In Active"})}),e(a.TH,{children:h(()=>new Date(i.created_at).toLocaleDateString())}),e(a.TH,{children:e("i",{className:"feather icon-edit cursor-pointer",onClick:()=>S(i)})})]},i.id))})]})}),e(q,{editValue:s,setEditValue:c,modalObj:{...o,onSubmit:v,isLoading:A}})]})};export{U as default};
